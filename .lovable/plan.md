

# 交易详情全屏页面改造方案

## 需求概述
将交易历史中的交易详情从当前的抽屉（Drawer）样式改造为全屏页面，并统一字号样式与转账确认页面保持一致。

---

## 当前实现分析

### 交易详情抽屉 (History.tsx)
- 位于 `History.tsx` 第 504-824 行
- 使用 `AnimatePresence` + `motion.div` 从底部滑入
- 包含：代币图标、金额、状态标签、发送方/收款方地址、网络、时间、费用、确认数、区块高度、Nonce、备注、交易哈希
- 风险交易展示风险原因和操作按钮
- Pending 交易展示加速/取消按钮

### 转账确认页面 (Send.tsx - confirm step)
- 全屏页面布局，有返回按钮和标题
- 使用 `card-elevated` 卡片样式
- 字号规范：
  - 金额：`text-3xl font-bold`
  - USD 值：`text-muted-foreground`（无特殊大小）
  - 标签：`text-sm text-muted-foreground`
  - 值：`font-medium text-foreground`

---

## 改造方案

### 方案：创建独立的交易详情页面

创建新的 `/transaction/:id` 页面路由，点击交易列表项时跳转到该页面。

**优点**：
- 页面独立，便于维护
- 符合移动端导航习惯
- 支持浏览器前进/后退

---

## 实现步骤

### 1. 创建交易详情页面组件
**新文件**: `src/pages/TransactionDetail.tsx`

页面结构：
```text
┌─────────────────────────────────┐
│ ← 返回         交易详情          │ (Header)
├─────────────────────────────────┤
│                                 │
│          [代币图标]              │
│           +100 USDT             │ (text-3xl font-bold)
│           ≈ $100.00             │ (text-muted-foreground)
│                                 │
│     [收款已完成]  [可疑]         │ (状态标签)
│                                 │
├─────────────────────────────────┤
│ 风险原因区块（如有）             │
│ 失败原因区块（如有）             │
├─────────────────────────────────┤
│ ┌─────────────────────────────┐ │
│ │ 发送方                      │ │
│ │ ABC Trading Co.             │ │
│ │ 0x1234...5678        📋    │ │
│ │─────────────────────────────│ │
│ │ 收款方                      │ │
│ │ 0xabcd...efgh        📋    │ │
│ │─────────────────────────────│ │
│ │ 网络           ◉ Ethereum  │ │
│ │─────────────────────────────│ │
│ │ 时间     2024/1/29 15:30   │ │
│ │─────────────────────────────│ │
│ │ 网络费用        0.0007 ETH │ │
│ │               ≈ $2.45      │ │
│ │─────────────────────────────│ │
│ │ 确认数          100+ 次    │ │
│ │─────────────────────────────│ │
│ │ 区块高度      #19,234,567  │ │
│ │─────────────────────────────│ │
│ │ Nonce              42      │ │
│ │─────────────────────────────│ │
│ │ 备注           月度结算    │ │
│ │─────────────────────────────│ │
│ │ 交易哈希  0x123...abc 📋 🔗│ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ [加速交易] [取消交易]            │ (Pending 交易)
│ 或                              │
│ [退回资金]                       │ (风险交易)
│ [我已知晓风险，保留资金]          │
└─────────────────────────────────┘
```

### 2. 添加路由配置
**文件**: `src/App.tsx`

添加新路由：
- `/transaction/:id` → `TransactionDetail` 组件

### 3. 修改 History.tsx
- 点击交易项时，使用 `navigate('/transaction/${tx.id}')` 跳转
- 移除现有的抽屉组件代码（约 320 行）
- 保留 RBF 相关 Drawer 组件（SpeedUpDrawer、CancelTxDrawer），移至新页面

### 4. 字号统一规范
与转账确认页面保持一致：

| 元素 | 样式 |
|------|------|
| 金额 | `text-3xl font-bold` |
| USD 等值 | `text-muted-foreground` |
| 详情标签 | `text-sm text-muted-foreground` |
| 详情值 | `font-medium text-foreground` |
| 地址 | `text-sm font-mono` |
| 卡片 | `card-elevated p-4` |

---

## 技术细节

### 文件变更清单

| 文件 | 操作 |
|------|------|
| `src/pages/TransactionDetail.tsx` | 新建 |
| `src/App.tsx` | 添加路由 |
| `src/pages/History.tsx` | 移除抽屉代码，改为路由跳转 |

### 状态管理
- 通过 URL 参数 `id` 查找交易
- 从 `WalletContext` 获取交易列表
- 复制状态在页面组件内管理

### 页面过渡动画
- 使用 `PageTransition` 组件包裹，实现滑入动画
- 返回时使用 `navigate(-1)` 或 `navigate('/history')`

### 处理逻辑迁移
以下功能需要迁移到新页面：
- 复制地址/交易哈希（带勾选反馈）
- 风险交易的「退回」「知晓」操作
- Pending 交易的加速/取消功能（调用 SpeedUpDrawer、CancelTxDrawer）

